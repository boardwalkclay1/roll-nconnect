<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Roll ’n Connect — Home</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="rc_style.css">
</head>

<body>

  <!-- STARFIELD -->
  <div class="stars1"></div>
  <div class="stars2"></div>
  <div class="stars3"></div>

  <!-- LOADING SCREEN -->
  <div class="rc-loading-overlay" id="loadingScreen">
    <div class="rc-loading-track">
      <div class="rc-longboard"></div>
      <div class="rc-rollerskate"></div>
    </div>
    <div class="rc-loading-text">Loading Roll ’n Connect…</div>
  </div>

  <!-- HAMBURGER -->
  <div class="hamburger" id="hamburger">
    <span></span><span></span><span></span>
  </div>

  <!-- SIDEBAR -->
  <div class="sidebar" id="sidebar">
    <h2>Menu</h2>
    <a href="index.html">Home</a>
    <a href="dashboard.html">Dashboard</a>
    <a href="marketplace.html">Marketplace</a>
    <a href="notifications.html">Notifications</a>
    <a href="chatrooms.html">Chatrooms</a>
    <a href="find-spots.html">Find Spots</a>
    <a href="events.html">Events</a>
    <a href="profile.html">Your Profile</a>
    <a href="profile-edit.html">Edit Profile</a>
  </div>

  <!-- FLOATING BUBBLES -->
  <a href="chatrooms.html" class="bubble" id="bubbleChat">Chatrooms</a>
  <a href="find-spots.html" class="bubble" id="bubbleSpots">Find Spots</a>
  <a href="events.html" class="bubble" id="bubbleEvents">Events</a>
  <a href="profile.html" class="bubble" id="bubbleProfile">Profile</a>
  <a href="marketplace.html" class="bubble" id="bubbleMarket">Marketplace</a>
  <a href="notifications.html" class="bubble" id="bubbleNotif">Notifications</a>

  <!-- MAIN WRAPPER -->
  <div class="wrapper">

    <!-- HERO -->
    <div class="glass" style="text-align:center;padding:60px 20px;margin-bottom:60px;">
      <h1 class="title glow-white">ROLL ’N CONNECT</h1>
      <p class="subtitle" style="font-size:1.3rem;max-width:800px;margin:0 auto;">
        The cosmic skating universe — floating, glowing, alive.
      </p>
      <p style="margin-top:10px;opacity:0.8;">by Boardwalk Clay</p>
    </div>

    <!-- MARKETPLACE PREVIEW -->
    <div class="glass section">
      <h2 class="section-title">Marketplace</h2>
      <div id="marketplaceItems" class="grid-3"></div>
    </div>

    <!-- GIVEAWAY PREVIEW -->
    <div class="glass section">
      <h2 class="section-title">Giveaway Items</h2>
      <div id="giveawayItems" class="grid-3"></div>
    </div>

  </div>

  <script src="rc_core.js"></script>
  <script src="rc_app_config.js"></script>

  <script>
    /* -----------------------------------------
       LOADING SCREEN
    ----------------------------------------- */
    window.addEventListener("load", () => {
      setTimeout(() => {
        document.getElementById("loadingScreen").style.opacity = "0";
        setTimeout(() => {
          document.getElementById("loadingScreen").style.display = "none";
        }, 600);
      }, 800);
    });

    /* -----------------------------------------
       SIDEBAR TOGGLE
    ----------------------------------------- */
    document.getElementById("hamburger").onclick = () => {
      document.getElementById("hamburger").classList.toggle("active");
      document.getElementById("sidebar").classList.toggle("open");
    };

    /* -----------------------------------------
       FLOATING BUBBLES (PONG ANIMATION)
    ----------------------------------------- */
    const bubbleSize = 180;
    const bubbles = [
      { el: document.getElementById("bubbleChat"),    x:60, y:110, vx:1.4, vy:1.1 },
      { el: document.getElementById("bubbleSpots"),   x:window.innerWidth-260, y:80, vx:-1.3, vy:1.4 },
      { el: document.getElementById("bubbleEvents"),  x:80, y:window.innerHeight-260, vx:1.6, vy:-1.2 },
      { el: document.getElementById("bubbleProfile"), x:window.innerWidth-260, y:window.innerHeight-260, vx:-1.5, vy:-1.3 },
      { el: document.getElementById("bubbleMarket"),  x:200, y:300, vx:1.2, vy:1.5 },
      { el: document.getElementById("bubbleNotif"),   x:500, y:200, vx:-1.4, vy:1.3 }
    ];

    function animateBubbles() {
      const w = window.innerWidth;
      const h = window.innerHeight;

      bubbles.forEach(b => {
        b.x += b.vx;
        b.y += b.vy;

        if (b.x <= 0 || b.x + bubbleSize >= w) b.vx *= -1;
        if (b.y <= 0 || b.y + bubbleSize >= h) b.vy *= -1;

        bubbles.forEach(o => {
          if (o === b) return;
          const dx = (b.x + bubbleSize/2) - (o.x + bubbleSize/2);
          const dy = (b.y + bubbleSize/2) - (o.y + bubbleSize/2);
          const dist = Math.sqrt(dx*dx + dy*dy);
          if (dist < bubbleSize) {
            b.vx *= -1;
            b.vy *= -1;
          }
        });

        b.el.style.left = b.x + "px";
        b.el.style.top = b.y + "px";
      });

      requestAnimationFrame(animateBubbles);
    }
    animateBubbles();

    /* -----------------------------------------
       MARKETPLACE + GIVEAWAY PREVIEW
    ----------------------------------------- */
    function renderMarketplace() {
      const items = RC.getMarketplaceItems();
      const marketWrap = document.getElementById("marketplaceItems");
      const giveawayWrap = document.getElementById("giveawayItems");

      marketWrap.innerHTML = "";
      giveawayWrap.innerHTML = "";

      const latest = items.slice(-6).reverse();
      latest.forEach(item => marketWrap.appendChild(makeCard(item)));

      const donated = items.filter(i => i.donateToGiveaway);
      donated.forEach(item => giveawayWrap.appendChild(makeCard(item)));

      if (!latest.length) {
        marketWrap.innerHTML = "<p style='opacity:0.7;'>No items yet.</p>";
      }
      if (!donated.length) {
        giveawayWrap.innerHTML = "<p style='opacity:0.7;'>No donated items yet.</p>";
      }
    }

    function makeCard(item) {
      const div = document.createElement("div");
      div.className = "glass-card";
      div.innerHTML = `
        <div style="width:100%;height:160px;border-radius:14px;overflow:hidden;background:rgba(255,255,255,0.1);margin-bottom:10px;">
          ${item.imageDataUrl ? `<img src="${item.imageDataUrl}" style="width:100%;height:100%;object-fit:cover;">` : ""}
        </div>
        <strong>${item.title}</strong><br>
        <span style="opacity:0.8;">${item.discipline || "Unlabeled"}</span><br>
        <span style="opacity:0.9;">$${item.price}</span><br>
        <a href="marketplace-item.html?id=${encodeURIComponent(item.id)}" class="btn-primary" style="margin-top:10px;display:inline-block;">View Item</a>
      `;
      return div;
    }

    renderMarketplace();
  </script>

</body>
</html>
